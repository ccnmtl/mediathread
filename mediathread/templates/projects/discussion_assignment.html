{% extends "base_new.html" %}

{% block title %}
    {{assignment.title}}
{% endblock %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{{STATIC_URL}}js/select2/select2.css" media="screen" />
    <link rel="stylesheet" href="{{STATIC_URL}}css/project.css" />
    <link rel="stylesheet" href="{{STATIC_URL}}js/lib/sherdjs/lib/tinymce/plugins/citation/css/citation.css" />

    <!--All the annotation css -->
    {% include "djangosherd/annotator_resources_css.html" %}
{% endblock %}

{% block uncompressable_css %}
    <script type="text/javascript" src="{{STATIC_URL}}js/select2/select2.min.js"></script>
{% endblock %}

{% block js %}
    <!--All the annotation javascript -->
    {% include "djangosherd/annotator_resources.html" %}
{% endblock %}

{% block uncompressable_js %}
    {% include "djangosherd/player_resources.html" %}
    <script type="text/javascript" src="{{STATIC_URL}}jquery/js/masonry.pkgd.min.js"></script>

    <script type="text/javascript" src="{{STATIC_URL}}js/lib/sherdjs/lib/tinymce/tinymce.min.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}js/app/tinymce_init.js"></script>

    <script type="text/javascript">
        jQuery(document).ready(function () {
            panelManager.init({
                'container': 'discussion-workspace',
                'url': MediaThread.urls['discussion-view']({{assignment.course_discussion.id}})
            });
        });
  </script>
{% endblock %}

{% block content %}
    {% with active='assignments' %}
        {% include 'main/three_section_tabs.html' %}
    {% endwith %}
    <div class="tab-content">
        <div role="tabpanel">
            <div class="row mt-2">
                <div class="col-md-auto">
                    <nav aria-label="breadcrumb">
                      <ol class="breadcrumb bg-light mb-0">
                        <li class="breadcrumb-item" aria-current="page">
                            <a href="{% url 'assignment-list' request.course.pk %}">
                                Back to assignments
                            </a>
                        </li>
                      </ol>
                    </nav>
                </div>
            </div>
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div class="col-md-6 text-right order-md-2">
                    {% if not is_faculty and responses|length > 1 %}
                        <button id="assignment-responses" type="button" class="btn btn-outline-secondary dropdown-toggle"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Class Responses
                        </button>
                        <div class="dropdown-menu" aria-labelledby="assignment-responses">
                            {% for response in responses %}
                                {% if response != my_response %}
                                    <a class="dropdown-item" href="{% url 'project-workspace' request.course.id response.id %}">
                                        {{response.attribution_last_first}}
                                    </a>
                                {% endif %}
                            {% endfor %}
                        </div>
                    {% endif %}
                    {% if assignment_can_edit %}
                        <a class="btn btn-outline-secondary btn-sm btn-edit-assignment"
                            href="{% url 'discussion-assignment-edit-wizard' request.course.pk assignment.id %}">
                            Edit Assignment
                        </a>
                    {% endif %}
                </div>
                <div class="col-md-6 pl-0 order-md-1">
                    <h1 class="page-title">
                        {{assignment.title}}
                    </h1>
                </div>
            </div>
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h5>
                        {% if assignment.due_date %}
                            Due {{assignment.due_date|date:'m/d/y'}}
                        {% else %}
                            No due date
                        {% endif %}
                    </h5>
                </div>
                <div>
                    {% if is_faculty and responses|length > 0 %}
                    <div class="input-group mb-3">
                          <div class="input-group-prepend">
                            <span class="input-group-text" id="student-responses-addon">
                                Select Student Response
                            </span>
                          </div>
                          <select id="student-responses"  placeholder="-----"
                                class="form-control" aria-label="Student Responses"
                                aria-describedby="student-response-addon">
                                <option value=''>-----</option>
                              {% for response in responses %}
                                    <option {% if response.id == the_response.id %}selected="selected"{% endif %}
                                        value="{% url 'project-workspace' request.course.id response.id %}">
                                        {{response.attribution}}
                                    </option>
                                {% endfor %}
                          </select>
                        </div>
                    {% endif %}
                </div>
                <div>
                    {% if is_faculty %}
                        <h5 class="pr-3 text-right project-visibility-description">
                            {{assignment.visibility_short}}
                        </h5>
                    {% endif %}
                </div>
            </div>
            <div id="discussion-workspace" class="row mt-3">
                <div id="discussion-container" class="col-md-12">
                </div>
            </div>
            <div id="asset-container" class="col-md-12">
            </div>
        </div>
    </div>
{% endblock %}
